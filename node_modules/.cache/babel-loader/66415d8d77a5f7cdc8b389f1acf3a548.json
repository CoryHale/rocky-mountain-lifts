{"ast":null,"code":"import _toConsumableArray from\"/Users/coryhale/Documents/Rocky Mountain Lifts/rocky-mountain-lifts copy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/coryhale/Documents/Rocky Mountain Lifts/rocky-mountain-lifts copy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{useHistory}from\"react-router-dom\";import{Button,Modal,ModalHeader,ModalBody,ModalFooter,Form,FormGroup,Label,Input}from\"reactstrap\";import FullCalendar from\"@fullcalendar/react\";import dayGridPlugin from\"@fullcalendar/daygrid\";import timeGridPlugin from\"@fullcalendar/timegrid\";import interactionPlugin from\"@fullcalendar/interaction\";import bootstrapPlugin from\"@fullcalendar/bootstrap\";import{deleteEvent}from\"../../actions/deleteEvent\";import\"@fullcalendar/daygrid/main.css\";import\"@fullcalendar/timegrid/main.css\";import\"../../styles/task.scss\";var TaskCalendar=function TaskCalendar(){var flag=useSelector(function(state){return state.taskToggleReducer.calendarView;});var _useState=useState([]),_useState2=_slicedToArray(_useState,2),events=_useState2[0],setEvents=_useState2[1];var _useState3=useState({title:\"\",extendedProps:{location:\"\",description:\"\",invitees:[],eventId:\"\"}}),_useState4=_slicedToArray(_useState3,2),curEvent=_useState4[0],setCurEvent=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),tasks=_useState6[0],setTasks=_useState6[1];var fetchTasks=useSelector(function(state){return state.getTasksReducer.tasks;});var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),otherEvents=_useState8[0],setOtherEvents=_useState8[1];var fetchEvents=useSelector(function(state){return state.getEventsReducer.events;});var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),workOrders=_useState10[0],setWorkOrders=_useState10[1];var fetchWorkOrders=useSelector(function(state){return state.getWorkOrdersReducer.workOrders;});var _useState11=useState(),_useState12=_slicedToArray(_useState11,2),employees=_useState12[0],setEmployees=_useState12[1];var fetchUsers=useSelector(function(state){return state.getUsersReducer.users;});var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),isOpen=_useState14[0],setIsOpen=_useState14[1];var success=useSelector(function(state){return state.deleteEventReducer.success;});var dispatch=useDispatch();var history=useHistory();useEffect(function(){if(fetchTasks){fetchTasks.tasks.map(function(task){setEvents(function(events){return[].concat(_toConsumableArray(events),[{title:task.taskDescription,date:task.taskDate}]);});});}},[fetchTasks]);useEffect(function(){var start=\"\";var end=\"\";if(fetchEvents){var array=[];fetchEvents.events.map(function(event){// if (event.startTime === \"\") {\n//   let allDay = true;\n// }\nif(event.startDate!==\"\"&&event.startTime!==\"\"){start=\"\".concat(event.startDate,\"T\").concat(event.startTime);}else{start=event.startDate;}if(event.endDate===\"\"&&event.endTime===\"\"){end=event.startDate;}else if(event.endDate===\"\"&&event.endTime!==\"\"){end=\"\".concat(event.startDate,\"T\").concat(event.endTime);}else if(event.endDate!==\"\"&&event.endTime!==\"\"){end=\"\".concat(event.endDate,\"T\").concat(event.endTime);}else{end=event.endDate;}if(event.recurring){array.push({title:event.title,// allDay: allDay,\nstartTime:event.startTime,endTime:event.endTime,startRecur:event.startDate,daysOfWeek:event.daysOfWeek,color:\"red\",extendedProps:{location:event.extendedProps.location,invitees:event.extendedProps.invitees,description:event.extendedProps.description,eventId:event.extendedProps.eventId,eventType:\"event\"}});}else{array.push({title:event.title,// allDay: allDay,\nstart:start,end:end,color:\"red\",extendedProps:{location:event.extendedProps.location,invitees:event.extendedProps.invitees,description:event.extendedProps.description,eventId:event.extendedProps.eventId,eventType:\"event\"}});}});console.log(array);setEvents(function(events){return[].concat(_toConsumableArray(events),array);});}},[fetchEvents]);useEffect(function(){if(fetchWorkOrders){fetchWorkOrders.workOrders.map(function(workOrder){setEvents(function(events){return[].concat(_toConsumableArray(events),[{title:workOrder.serviceDescription,allDay:workOrder.allDay,start:\"\".concat(workOrder.serviceDate,\"T\").concat(workOrder.serviceStartTime),end:\"\".concat(workOrder.serviceDate,\"T\").concat(workOrder.serviceEndTime),color:\"green\",extendedProps:{workOrderId:workOrder.workOrderId}}]);});});}},[fetchWorkOrders]);useEffect(function(){var array=[];if(fetchUsers){fetchUsers.users.map(function(user){if(user.userType===\"employee\"&&user.active===true){array.push({name:\"\".concat(user.firstName,\" \").concat(user.lastName),userId:user.userId});}});}setEmployees(array);},[fetchUsers]);useEffect(function(){if(success){toggle();}},[success]);var decoder=function decoder(invitees){var array=[];if(invitees){if(invitees[0]===\"Everyone\"){return\"Everyone\";}else{invitees.forEach(function(person){employees.forEach(function(employee){if(person===employee.userId){array.push(employee.name);}});});return array.join(\", \");}}};var toggle=function toggle(event){if(isOpen){setCurEvent({title:\"\",extendedProps:{location:\"\",description:\"\",invitees:[],eventId:\"\"}});}else{setCurEvent(event);}setIsOpen(!isOpen);};var handleEventClick=function handleEventClick(event){var workOrderId=event.event._def.extendedProps.workOrderId;var eventType=event.event._def.extendedProps.eventType;if(workOrderId){history.push(\"/dashboard/workorders/\".concat(workOrderId));}if(eventType){toggle(event.event._def);}};var handleDeleteEvent=function handleDeleteEvent(e,eventId){e.preventDefault();dispatch(deleteEvent(eventId));};return/*#__PURE__*/React.createElement(\"div\",{className:\"calendar-page\"},/*#__PURE__*/React.createElement(FullCalendar,{plugins:[dayGridPlugin,timeGridPlugin,interactionPlugin,bootstrapPlugin],initialView:\"dayGridMonth\",headerToolbar:{left:\"prev,next today\",center:\"title\",right:\"dayGridMonth,timeGridWeek,timeGridDay\"},events:events,eventClick:handleEventClick,themeSystem:\"bootstrap\",height:\"auto\"}),/*#__PURE__*/React.createElement(Modal,{isOpen:isOpen,toggle:toggle},/*#__PURE__*/React.createElement(ModalHeader,{toggle:toggle},curEvent.title),/*#__PURE__*/React.createElement(ModalBody,null,/*#__PURE__*/React.createElement(Form,null,/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(Label,null,\"Description\"),/*#__PURE__*/React.createElement(Input,{type:\"textarea\",disabled:true,value:curEvent.extendedProps.description})),/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(Label,null,\"Location\"),/*#__PURE__*/React.createElement(Input,{type:\"text\",disabled:true,value:curEvent.extendedProps.location})),/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(Label,null,\"Attendees\"),/*#__PURE__*/React.createElement(Input,{type:\"text\",disabled:true,value:decoder(curEvent.extendedProps.invitees)})))),/*#__PURE__*/React.createElement(ModalFooter,null,/*#__PURE__*/React.createElement(Button,{color:\"danger\",onClick:function onClick(e){return handleDeleteEvent(e,curEvent.extendedProps.eventId);}},\"Delete Event\"))));};export default TaskCalendar;","map":{"version":3,"sources":["/Users/coryhale/Documents/Rocky Mountain Lifts/rocky-mountain-lifts copy/src/components/content-components/Calendar.js"],"names":["React","useState","useEffect","useDispatch","useSelector","useHistory","Button","Modal","ModalHeader","ModalBody","ModalFooter","Form","FormGroup","Label","Input","FullCalendar","dayGridPlugin","timeGridPlugin","interactionPlugin","bootstrapPlugin","deleteEvent","TaskCalendar","flag","state","taskToggleReducer","calendarView","events","setEvents","title","extendedProps","location","description","invitees","eventId","curEvent","setCurEvent","tasks","setTasks","fetchTasks","getTasksReducer","otherEvents","setOtherEvents","fetchEvents","getEventsReducer","workOrders","setWorkOrders","fetchWorkOrders","getWorkOrdersReducer","employees","setEmployees","fetchUsers","getUsersReducer","users","isOpen","setIsOpen","success","deleteEventReducer","dispatch","history","map","task","taskDescription","date","taskDate","start","end","array","event","startDate","startTime","endDate","endTime","recurring","push","startRecur","daysOfWeek","color","eventType","console","log","workOrder","serviceDescription","allDay","serviceDate","serviceStartTime","serviceEndTime","workOrderId","user","userType","active","name","firstName","lastName","userId","toggle","decoder","forEach","person","employee","join","handleEventClick","_def","handleDeleteEvent","e","preventDefault","left","center","right"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useHistory } from \"react-router-dom\";\nimport {\n  Button,\n  Modal,\n  ModalHeader,\n  ModalBody,\n  ModalFooter,\n  Form,\n  FormGroup,\n  Label,\n  Input,\n} from \"reactstrap\";\nimport FullCalendar from \"@fullcalendar/react\";\nimport dayGridPlugin from \"@fullcalendar/daygrid\";\nimport timeGridPlugin from \"@fullcalendar/timegrid\";\nimport interactionPlugin from \"@fullcalendar/interaction\";\nimport bootstrapPlugin from \"@fullcalendar/bootstrap\";\nimport { deleteEvent } from \"../../actions/deleteEvent\";\n\nimport \"@fullcalendar/daygrid/main.css\";\nimport \"@fullcalendar/timegrid/main.css\";\nimport \"../../styles/task.scss\";\n\nconst TaskCalendar = () => {\n  const flag = useSelector((state) => state.taskToggleReducer.calendarView);\n  const [events, setEvents] = useState([]);\n  const [curEvent, setCurEvent] = useState({\n    title: \"\",\n    extendedProps: {\n      location: \"\",\n      description: \"\",\n      invitees: [],\n      eventId: \"\",\n    },\n  });\n  const [tasks, setTasks] = useState([]);\n  const fetchTasks = useSelector((state) => state.getTasksReducer.tasks);\n  const [otherEvents, setOtherEvents] = useState([]);\n  const fetchEvents = useSelector((state) => state.getEventsReducer.events);\n  const [workOrders, setWorkOrders] = useState([]);\n  const fetchWorkOrders = useSelector(\n    (state) => state.getWorkOrdersReducer.workOrders\n  );\n  const [employees, setEmployees] = useState();\n  const fetchUsers = useSelector((state) => state.getUsersReducer.users);\n  const [isOpen, setIsOpen] = useState(false);\n  const success = useSelector((state) => state.deleteEventReducer.success);\n  const dispatch = useDispatch();\n  const history = useHistory();\n\n  useEffect(() => {\n    if (fetchTasks) {\n      fetchTasks.tasks.map((task) => {\n        setEvents((events) => [\n          ...events,\n          {\n            title: task.taskDescription,\n            date: task.taskDate,\n          },\n        ]);\n      });\n    }\n  }, [fetchTasks]);\n\n  useEffect(() => {\n    let start = \"\";\n    let end = \"\";\n\n    if (fetchEvents) {\n      const array = [];\n\n      fetchEvents.events.map((event) => {\n        // if (event.startTime === \"\") {\n        //   let allDay = true;\n        // }\n\n        if (event.startDate !== \"\" && event.startTime !== \"\") {\n          start = `${event.startDate}T${event.startTime}`;\n        } else {\n          start = event.startDate;\n        }\n\n        if (event.endDate === \"\" && event.endTime === \"\") {\n          end = event.startDate;\n        } else if (event.endDate === \"\" && event.endTime !== \"\") {\n          end = `${event.startDate}T${event.endTime}`;\n        } else if (event.endDate !== \"\" && event.endTime !== \"\") {\n          end = `${event.endDate}T${event.endTime}`;\n        } else {\n          end = event.endDate;\n        }\n\n        if (event.recurring) {\n          array.push({\n            title: event.title,\n            // allDay: allDay,\n            startTime: event.startTime,\n            endTime: event.endTime,\n            startRecur: event.startDate,\n            daysOfWeek: event.daysOfWeek,\n            color: \"red\",\n            extendedProps: {\n              location: event.extendedProps.location,\n              invitees: event.extendedProps.invitees,\n              description: event.extendedProps.description,\n              eventId: event.extendedProps.eventId,\n              eventType: \"event\",\n            },\n          });\n        } else {\n          array.push({\n            title: event.title,\n            // allDay: allDay,\n            start: start,\n            end: end,\n            color: \"red\",\n            extendedProps: {\n              location: event.extendedProps.location,\n              invitees: event.extendedProps.invitees,\n              description: event.extendedProps.description,\n              eventId: event.extendedProps.eventId,\n              eventType: \"event\",\n            },\n          });\n        }\n      });\n      console.log(array);\n      setEvents((events) => [...events, ...array]);\n    }\n  }, [fetchEvents]);\n\n  useEffect(() => {\n    if (fetchWorkOrders) {\n      fetchWorkOrders.workOrders.map((workOrder) => {\n        setEvents((events) => [\n          ...events,\n          {\n            title: workOrder.serviceDescription,\n            allDay: workOrder.allDay,\n            start: `${workOrder.serviceDate}T${workOrder.serviceStartTime}`,\n            end: `${workOrder.serviceDate}T${workOrder.serviceEndTime}`,\n            color: \"green\",\n            extendedProps: {\n              workOrderId: workOrder.workOrderId,\n            },\n          },\n        ]);\n      });\n    }\n  }, [fetchWorkOrders]);\n\n  useEffect(() => {\n    const array = [];\n\n    if (fetchUsers) {\n      fetchUsers.users.map((user) => {\n        if (user.userType === \"employee\" && user.active === true) {\n          array.push({\n            name: `${user.firstName} ${user.lastName}`,\n            userId: user.userId,\n          });\n        }\n      });\n    }\n\n    setEmployees(array);\n  }, [fetchUsers]);\n\n  useEffect(() => {\n    if(success) {\n      toggle()\n    }\n  }, [success]);\n\n  const decoder = (invitees) => {\n    const array = [];\n\n    if (invitees) {\n      if (invitees[0] === \"Everyone\") {\n        return \"Everyone\";\n      } else {\n        invitees.forEach((person) => {\n          employees.forEach((employee) => {\n            if (person === employee.userId) {\n              array.push(employee.name);\n            }\n          });\n        });\n        return array.join(\", \");\n      }\n    }\n  };\n\n  const toggle = (event) => {\n    if (isOpen) {\n      setCurEvent({\n        title: \"\",\n        extendedProps: {\n          location: \"\",\n          description: \"\",\n          invitees: [],\n          eventId: \"\",\n        },\n      });\n    } else {\n      setCurEvent(event);\n    }\n    setIsOpen(!isOpen);\n  };\n\n  const handleEventClick = (event) => {\n    const workOrderId = event.event._def.extendedProps.workOrderId;\n    const eventType = event.event._def.extendedProps.eventType;\n\n    if (workOrderId) {\n      history.push(`/dashboard/workorders/${workOrderId}`);\n    }\n\n    if (eventType) {\n      toggle(event.event._def);\n    }\n  };\n\n  const handleDeleteEvent = (e, eventId) => {\n    e.preventDefault();\n    dispatch(deleteEvent(eventId));\n  };\n\n  return (\n    <div className=\"calendar-page\">\n      <FullCalendar\n        plugins={[\n          dayGridPlugin,\n          timeGridPlugin,\n          interactionPlugin,\n          bootstrapPlugin,\n        ]}\n        initialView=\"dayGridMonth\"\n        headerToolbar={{\n          left: \"prev,next today\",\n          center: \"title\",\n          right: \"dayGridMonth,timeGridWeek,timeGridDay\",\n        }}\n        events={events}\n        eventClick={handleEventClick}\n        themeSystem=\"bootstrap\"\n        height=\"auto\"\n      />\n\n      <Modal isOpen={isOpen} toggle={toggle}>\n        <ModalHeader toggle={toggle}>{curEvent.title}</ModalHeader>\n        <ModalBody>\n          <Form>\n            <FormGroup>\n              <Label>Description</Label>\n              <Input\n                type=\"textarea\"\n                disabled\n                value={curEvent.extendedProps.description}\n              />\n            </FormGroup>\n            <FormGroup>\n              <Label>Location</Label>\n              <Input\n                type=\"text\"\n                disabled\n                value={curEvent.extendedProps.location}\n              />\n            </FormGroup>\n            <FormGroup>\n              <Label>Attendees</Label>\n              <Input\n                type=\"text\"\n                disabled\n                value={decoder(curEvent.extendedProps.invitees)}\n              />\n            </FormGroup>\n          </Form>\n        </ModalBody>\n        <ModalFooter>\n          <Button\n            color=\"danger\"\n            onClick={(e) =>\n              handleDeleteEvent(e, curEvent.extendedProps.eventId)\n            }\n          >\n            Delete Event\n          </Button>\n        </ModalFooter>\n      </Modal>\n    </div>\n  );\n};\n\nexport default TaskCalendar;\n"]},"metadata":{},"sourceType":"module"}