{"ast":null,"code":"import _defineProperty from\"/Users/coryhale/Documents/Rocky Mountain Lifts/rocky-mountain-lifts copy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/coryhale/Documents/Rocky Mountain Lifts/rocky-mountain-lifts copy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/coryhale/Documents/Rocky Mountain Lifts/rocky-mountain-lifts copy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{useLocation}from\"react-router-dom\";import{Card,Button,Modal,ModalHeader,ModalBody,ModalFooter,Form,FormGroup,Label,Input}from\"reactstrap\";import{useAuth}from\"../../contexts/AuthContext\";import{addNote}from\"../../actions/addNote\";import{getCustomerNotes}from\"../../actions/getCustomerNotes\";var NoteTab=function NoteTab(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),notes=_useState2[0],setNotes=_useState2[1];var getNotesFromState=useSelector(function(state){return state.getCustomerNotesReducer.notes;});var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isOpen=_useState4[0],setIsOpen=_useState4[1];var _useState5=useState({note:\"\",createdBy:\"\",createdOnDate:\"\",createdAtTime:\"\",customerId:\"\"}),_useState6=_slicedToArray(_useState5,2),note=_useState6[0],setNote=_useState6[1];var success=useSelector(function(state){return state.addNoteReducer.success;});var _useAuth=useAuth(),currentUser=_useAuth.currentUser;var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),flag=_useState8[0],setFlag=_useState8[1];var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),employees=_useState10[0],setEmployees=_useState10[1];var fetchUsers=useSelector(function(state){return state.getUsersReducer.users;});var dispatch=useDispatch();var location=useLocation();useEffect(function(){var pathArray=location.pathname.split(\"/\");var customerId=pathArray[pathArray.length-1];setNote(_objectSpread(_objectSpread({},note),{},{customerId:customerId}));dispatch(getCustomerNotes(customerId));},[]);useEffect(function(){if(getNotesFromState){setNotes(getNotesFromState);}},[getNotesFromState]);useEffect(function(){if(flag){dispatch(addNote(note));}},[flag]);useEffect(function(){if(success){toggle();}},[success]);useEffect(function(){var array=[];if(fetchUsers.users){fetchUsers.users.forEach(function(user){if(user.userType===\"employee\"&&user.active===true){array.push(user);}});}setEmployees(array);},[fetchUsers]);var toggle=function toggle(){if(isOpen){setNote({note:\"\",createdOnDate:\"\",createdAtTime:\"\",createdBy:\"\"});}setIsOpen(!isOpen);};var employeeFinder=function employeeFinder(createdBy){var name;employees.forEach(function(employee){if(employee.userId===createdBy){name=\"\".concat(employee.firstName,\" \").concat(employee.lastName);}});return name;};var handleChange=function handleChange(e){setNote(_objectSpread(_objectSpread({},note),{},_defineProperty({},e.target.name,e.target.value)));};var handleSubmit=function handleSubmit(e){e.preventDefault();setNote(_objectSpread(_objectSpread({},note),{},{createdOnDate:new Date().toLocaleDateString(),createdAtTime:new Date().toLocaleTimeString(),createdBy:currentUser.uid}));setFlag(true);};return/*#__PURE__*/React.createElement(\"div\",{className:\"customer-page-note-tab\"},notes?notes.notes?notes.notes.map(function(note){return/*#__PURE__*/React.createElement(Card,{className:\"note-card\"},/*#__PURE__*/React.createElement(\"p\",null,note.note),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"p\",null,\"Created By: \",/*#__PURE__*/React.createElement(\"span\",null,employeeFinder(note.createdBy))),/*#__PURE__*/React.createElement(\"p\",null,\"Created: \",note.createdOnDate,\" @ \",note.createdAtTime),\" \"));}):null:null,/*#__PURE__*/React.createElement(Button,{outline:true,color:\"success\",onClick:toggle},\"Add Note\"),/*#__PURE__*/React.createElement(Modal,{isOpen:isOpen,toggle:toggle},/*#__PURE__*/React.createElement(ModalHeader,{toggle:toggle},\"Add Note\"),/*#__PURE__*/React.createElement(ModalBody,null,/*#__PURE__*/React.createElement(Form,{onSubmit:handleSubmit},/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(Label,{for:\"note\"},\"Note\"),/*#__PURE__*/React.createElement(Input,{type:\"textarea\",name:\"note\",onChange:handleChange})))),/*#__PURE__*/React.createElement(ModalFooter,null,/*#__PURE__*/React.createElement(Button,{color:\"success\",onClick:handleSubmit},\"Submit\"))));};export default NoteTab;","map":{"version":3,"sources":["/Users/coryhale/Documents/Rocky Mountain Lifts/rocky-mountain-lifts copy/src/components/customer-page-components/NoteTab.js"],"names":["React","useState","useEffect","useDispatch","useSelector","useLocation","Card","Button","Modal","ModalHeader","ModalBody","ModalFooter","Form","FormGroup","Label","Input","useAuth","addNote","getCustomerNotes","NoteTab","notes","setNotes","getNotesFromState","state","getCustomerNotesReducer","isOpen","setIsOpen","note","createdBy","createdOnDate","createdAtTime","customerId","setNote","success","addNoteReducer","currentUser","flag","setFlag","employees","setEmployees","fetchUsers","getUsersReducer","users","dispatch","location","pathArray","pathname","split","length","toggle","array","forEach","user","userType","active","push","employeeFinder","name","employee","userId","firstName","lastName","handleChange","e","target","value","handleSubmit","preventDefault","Date","toLocaleDateString","toLocaleTimeString","uid","map"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useLocation } from \"react-router-dom\";\nimport {\n  Card,\n  Button,\n  Modal,\n  ModalHeader,\n  ModalBody,\n  ModalFooter,\n  Form,\n  FormGroup,\n  Label,\n  Input,\n} from \"reactstrap\";\nimport { useAuth } from \"../../contexts/AuthContext\";\nimport { addNote } from \"../../actions/addNote\";\nimport { getCustomerNotes } from \"../../actions/getCustomerNotes\";\n\nconst NoteTab = () => {\n  const [notes, setNotes] = useState([]);\n  const getNotesFromState = useSelector(\n    (state) => state.getCustomerNotesReducer.notes\n  );\n  const [isOpen, setIsOpen] = useState(false);\n  const [note, setNote] = useState({\n    note: \"\",\n    createdBy: \"\",\n    createdOnDate: \"\",\n    createdAtTime: \"\",\n    customerId: \"\",\n  });\n  const success = useSelector((state) => state.addNoteReducer.success);\n  const { currentUser } = useAuth();\n  const [flag, setFlag] = useState(false);\n  const [employees, setEmployees] = useState();\n  const fetchUsers = useSelector((state) => state.getUsersReducer.users);\n  const dispatch = useDispatch();\n  const location = useLocation();\n\n  useEffect(() => {\n    const pathArray = location.pathname.split(\"/\");\n    const customerId = pathArray[pathArray.length - 1];\n    setNote({\n      ...note,\n      customerId: customerId,\n    });\n    dispatch(getCustomerNotes(customerId));\n  }, []);\n\n  useEffect(() => {\n    if (getNotesFromState) {\n      setNotes(getNotesFromState);\n    }\n  }, [getNotesFromState]);\n\n  useEffect(() => {\n    if (flag) {\n      dispatch(addNote(note));\n    }\n  }, [flag]);\n\n  useEffect(() => {\n    if (success) {\n      toggle();\n    }\n  }, [success]);\n\n  useEffect(() => {\n    const array = [];\n\n    if (fetchUsers.users) {\n      fetchUsers.users.forEach((user) => {\n        if (user.userType === \"employee\" && user.active === true) {\n          array.push(user);\n        }\n      });\n    }\n    setEmployees(array);\n  }, [fetchUsers]);\n\n  const toggle = () => {\n    if (isOpen) {\n      setNote({\n        note: \"\",\n        createdOnDate: \"\",\n        createdAtTime: \"\",\n        createdBy: \"\",\n      });\n    }\n    setIsOpen(!isOpen);\n  };\n\n  const employeeFinder = (createdBy) => {\n    var name;\n\n    employees.forEach((employee) => {\n      if (employee.userId === createdBy) {\n        name = `${employee.firstName} ${employee.lastName}`\n      }\n    });\n    return name;\n  };\n\n  const handleChange = (e) => {\n    setNote({\n      ...note,\n      [e.target.name]: e.target.value,\n    });\n  };\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    setNote({\n      ...note,\n      createdOnDate: new Date().toLocaleDateString(),\n      createdAtTime: new Date().toLocaleTimeString(),\n      createdBy: currentUser.uid,\n    });\n    setFlag(true);\n  };\n\n  return (\n    <div className=\"customer-page-note-tab\">\n      {notes\n        ? notes.notes\n          ? notes.notes.map((note) => (\n              <Card className=\"note-card\">\n                <p>{note.note}</p>\n                <div>\n                  <p>\n                    Created By: <span>{employeeFinder(note.createdBy)}</span>\n                  </p>\n                  <p>\n                    Created: {note.createdOnDate} @ {note.createdAtTime}\n                  </p>{\" \"}\n                  {/* Fix time format */}\n                </div>\n              </Card>\n            ))\n          : null\n        : null}\n      <Button outline color=\"success\" onClick={toggle}>\n        Add Note\n      </Button>\n      <Modal isOpen={isOpen} toggle={toggle}>\n        <ModalHeader toggle={toggle}>Add Note</ModalHeader>\n        <ModalBody>\n          <Form onSubmit={handleSubmit}>\n            <FormGroup>\n              <Label for=\"note\">Note</Label>\n              <Input type=\"textarea\" name=\"note\" onChange={handleChange} />\n            </FormGroup>\n          </Form>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"success\" onClick={handleSubmit}>\n            Submit\n          </Button>\n        </ModalFooter>\n      </Modal>\n    </div>\n  );\n};\n\nexport default NoteTab;\n"]},"metadata":{},"sourceType":"module"}